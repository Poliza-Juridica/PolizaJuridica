<div class="col-lg-12 col-md-12">
    <div class="card">
        <div class="card-header card-header-icon" data-background-color="rose">
            <i class="material-icons">contacts</i>
        </div>
        <div class="card-content">
            <h4 class="card-title">Cuenta</h4>
            <div class="toolbar" align="right">
                <button type="button" class="btn btn-primary" onclick="GenerarMovimiento()" onclick="this.disabled=true;">Generar Movimiento</button>
            </div>
            <div class="row">
                <table id="tablaCuenta" class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                    <thead>
                        <tr>
                            <th> Cuenta</th>
                            <th> Sub-Entrada</th>
                            <th> Sub-Salida</th>
                            <th> Total</th>
                            <th>Proyección Saldo de la Cuenta</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="col-lg-12 col-md-12">
    <div class="card card-pricing card-raised">
        <div class="content">
            <h3>Detalle de Póliza </h3>
            <div class="row">
                <div class="material-datatables">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header card-header-icon" data-background-color="red">
                                    <i class="material-icons">perm_identity</i>
                                </div>
                                <div class="card-content">
                                    <div class="row">
                                        <a class="btn btn-primary" href="" data-toggle="modal" data-target="#ModalDP">Seleccionar</a>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <table class="table" id="DPtable">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            Id
                                                        </th>
                                                        <th>
                                                            Póliza Id
                                                        </th>
                                                        <th>
                                                            Concepto
                                                        </th>
                                                        <th>
                                                            Flujo
                                                        </th>
                                                        <th>
                                                            Importe
                                                        </th>
                                                        <th>Acciones</th>
                                                    </tr>
                                                    <tr>
                                                        <td>Sub-Total de Entrada: <input name="SubEntradaDP" disabled></td>
                                                        <td></td>
                                                        <td>Sub-Total de Salidas: <input name="SubSalidaDP" disabled></td>
                                                        <td></td>
                                                        <td>Total de Entrada: <input name="SubTotalDP" disabled></td>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
<div class="col-lg-12 col-md-12">
    <div class="card card-pricing card-raised">
        <div class="content">
            <h3>Cuentas por Pagar </h3>
            <div class="row">
                <div class="material-datatables">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header card-header-icon" data-background-color="blue">
                                    <i class="material-icons">perm_identity</i>
                                </div>
                                <div class="card-content">
                                    <div class="row">
                                        <a class="btn btn-primary" href="" data-toggle="modal" data-target="#ModalCXP">Seleccionar</a>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <table class="table"  id="CXPtable">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            Id
                                                        </th>
                                                        <th>
                                                            Póliza Id
                                                        </th>

                                                        <th>
                                                            Concepto
                                                        </th>
                                                        <th>
                                                            Flujo
                                                        </th>
                                                        <th>
                                                            Importe
                                                        </th>
                                                        <th>Acciones</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="col-lg-12 col-md-12">
    <div class="card card-pricing card-raised">
        <div class="content">
            <h3>Transferencias </h3>
            <div class="row">
                <div class="material-datatables">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header card-header-icon" data-background-color="orange">
                                    <i class="material-icons">perm_identity</i>
                                </div>
                                <div class="card-content">
                                    <div class="row">
                                        <a class="btn btn-primary" href="" data-toggle="modal" data-target="#ModalTrans">Seleccionar</a>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <table class="table"  id="Transtable">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            Id
                                                        </th>
                                                        <th>
                                                            Tipo
                                                        </th>
                                                        <th>
                                                            Importe
                                                        </th>
                                                        <th>
                                                            Referencia
                                                        </th>
                                                        <th>
                                                            Origen
                                                        </th>
                                                        <th>Acciones</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="col-lg-12 col-md-12">
    <div class="card card-pricing card-raised">
        <div class="content">
            <h3>Cuentas por Cobrar </h3>
            <div class="row">
                <div class="material-datatables">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header card-header-icon" data-background-color="green">
                                    <i class="material-icons">perm_identity</i>
                                </div>
                                <div class="card-content">
                                    <div class="row">
                                        <a class="btn btn-primary" href="" data-toggle="modal" data-target="#ModalCXC">Seleccionar</a>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <table class="table"  id="CXCtable">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            Id
                                                        </th>
                                                        <th>
                                                            Póliza Id
                                                        </th>
                                                        <th>
                                                            Importe Inicio
                                                        </th>
                                                        <th>
                                                            Incrementador
                                                        </th>
                                                        <th>
                                                            Importe Con Incremento
                                                        </th>
                                                        <th>Acciones</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--DP-->
<div class="modal fade" id="ModalDP" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Listado de Detalle de Pólizas</h4>
            </div>
            <div class="modal-body">
                <div class="material-datatables">
                    <table id="datatablesDetallePoliza" class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                        <thead>
                            <tr>
                                <th>
                                    Id
                                </th>
                                <th>
                                    Póliza Id
                                </th>
                                <th>
                                    Concepto
                                </th>
                                <th>
                                    Flujo
                                </th>
                                <th>
                                    Importe
                                </th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var dp in ViewData["DetallePoliza"] as IList<DetallePoliza>)
                            {
                                <tr>
                                    <td>@dp.DetallePolizaId</td>
                                    <td>@dp.PolizaId</td>
                                    <td>@dp.CategoriaEs.Descripcion</td>
                                    @if (dp.CategoriaEs.TipoEs == 1)
                                    {
                                        <td>Entrada</td>
                                    }
                                    @if (dp.CategoriaEs.TipoEs == 2)
                                    {
                                        <td>Salida</td>
                                    }
                                    <td>@dp.Importe</td>
                                    <td>
                                        <a href="#" onclick="DataDP('@dp.DetallePolizaId','@dp.PolizaId','@dp.CategoriaEs.Descripcion','@dp.CategoriaEs.TipoEs','@dp.Importe')"><i class="material-icons">done</i></a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>
<!--DP-->
<!--CXP-->
<div class="modal fade" id="ModalCXP" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Listado de Cuentas por Pagar</h4>
            </div>
            <div class="modal-body">
                <div class="material-datatables">
                    <table id="datatablesCuentasPagar" class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                        <thead>
                            <tr>
                                <th>
                                    Id
                                </th>
                                <th>
                                    Póliza Id
                                </th>

                                <th>
                                    Concepto
                                </th>
                                <th>
                                    Flujo
                                </th>
                                <th>
                                    Importe
                                </th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var cp in ViewData["CuentasXPagar"] as IList<CuentasXpagar>)
                            {
                                <tr>
                                    <td>@cp.Cpid</td>
                                    <td>@cp.PolizaId</td>
                                    <td>@cp.Categoria.Descripcion</td>
                                    @if (cp.Categoria.TipoEs == 1)
                                    {
                                        <td>Entrada</td>
                                    }
                                    @if (cp.Categoria.TipoEs == 2)
                                    {
                                        <td>Salida</td>
                                    }
                                    <td>@cp.Importe</td>
                                    <td>
                                        <a href="#" onclick="DataCXP('@cp.Cpid','@cp.PolizaId','@cp.Categoria.Descripcion','@cp.Categoria.TipoEs','@cp.Importe')"><i class="material-icons">done</i></a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>
<!--CXP-->
<!--CXC-->
<div class="modal fade" id="ModalCXC" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Listado de Cuentas por Cobrar</h4>
            </div>
            <div class="modal-body">
                <div class="material-datatables">
                    <table id="datatablesCuentasXCobrar" class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                        <thead>
                            <tr>
                                <th>
                                    Id
                                </th>
                                <th>
                                    Póliza Id
                                </th>
                                <th>
                                    Importe Inicio
                                </th>
                                <th>
                                    Incrementador
                                </th>
                                <th>
                                    Importe Con Incremento
                                </th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var cc in ViewData["CuentasXCobrar"] as IList<CuentasXcobrar>)
                            {
                                <tr>
                                    <td>@cc.Ccid</td>
                                    <td>@cc.PolizaId</td>
                                    <td>$ @cc.Importe</td>
                                    <td>@cc.Numeral</td>
                                    <td>@cc.ImporteIncr</td>
                                    <td>
                                        <a href="#" onclick="DataCXC('@cc.Ccid','@cc.PolizaId','@cc.Importe','@cc.Numeral','@cc.ImporteIncr')"><i class="material-icons">done</i></a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>
<!--CXC-->
<!--Trans-->
<div class="modal fade" id="ModalTrans" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Listado de Cuentas por Cobrar</h4>
            </div>
            <div class="modal-body">
                <div class="material-datatables">
                    <table id="datatablesDetalleMovimiento" class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                        <thead>
                            <tr>
                                <th>
                                    Id
                                </th>
                                <th>
                                    Tipo
                                </th>
                                <th>
                                    Importe
                                </th>
                                <th>
                                    Referencia
                                </th>
                                <th>
                                    Origen
                                </th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var dm in ViewData["DetalleMovimiento"] as IList<DetalleMovimiento>)
                            {
                                <tr>
                                    <td>@dm.Id</td>
                                    <td>@dm.Tipo</td>
                                    <td>@dm.Importe</td>
                                    <td>@dm.Referencias</td>
                                    <td>@dm.Origen</td>
                                    <td>
                                        <a href="#" onclick="DataTrans('@dm.Id','@dm.Tipo','@dm.Importe','@dm.Referencias','@dm.Origen')"><i class="material-icons">done</i></a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>
<!--Trans-->

@section Scripts
    {
    <script type="text/javascript">
        var Cuenta = '@ViewBag.Cuenta';
        var saldoPro = '@ViewBag.Saldo';
        var Saldo = 0;
        var SubEntrada = 0;
        var SubSalida = 0;
        var isBandera = false;
        var Total = 0;
        var SubEntradaDP = 0;
        var SubSalidaDP = 0;
        var SubTotalDP = 0;

        let Movimiento = {
            movimiento: {
                dp: [],
                cxp: [],
                cxc: [],
                trans: [],
                Cuenta: @ViewBag.CuentaId
            }
        };
        $(document).ready(function () {

            $('#datatablesDetallePoliza').DataTable({
                "pagingType": "full_numbers",
                "lengthMenu": [
                    [10, 25, 50, -1],
                    [10, 25, 50, "All"]
                ],
                responsive: true,
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Buscar",
                }

            });
            $('#datatablesCuentasPagar').DataTable({
                "pagingType": "full_numbers",
                "lengthMenu": [
                    [10, 25, 50, -1],
                    [10, 25, 50, "All"]
                ],
                responsive: true,
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Buscar",
                }

            });
            $('#datatablesCuentasXCobrar').DataTable({
                "pagingType": "full_numbers",
                "lengthMenu": [
                    [10, 25, 50, -1],
                    [10, 25, 50, "All"]
                ],
                responsive: true,
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Buscar",
                }

            });
            $('#datatablesDetalleMovimiento').DataTable({
                "pagingType": "full_numbers",
                "lengthMenu": [
                    [10, 25, 50, -1],
                    [10, 25, 50, "All"]
                ],
                responsive: true,
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Buscar",
                }

            });
        });
        function agregarFila() {
            if (saldoPro != undefined) {
                Saldo = parseFloat(saldoPro);
            }
            if (Saldo == 0 || Saldo == undefined) {
                document.getElementById("tablaCuenta").insertRow(1).innerHTML = '<td>' + Cuenta + '</td><td>0</td><td>0</td><td>0</td><td> $ 0 </td>';
            } else {
                if (isBandera == false) {
                    document.getElementById("tablaCuenta").insertRow(1).innerHTML = '<td>' + Cuenta + '</td><td>' + SubEntrada.toString() + '</td><td>'
                        + SubSalida.toString() + '</td><td>' + Total.toString() + '</td><td>' + Saldo.toString() + '</td>';
                    isBandera = true;
                }

                document.getElementById("tablaCuenta").deleteRow(1);
                document.getElementById("tablaCuenta").insertRow(1).innerHTML = '<td>' + Cuenta + '</td><td>' + SubEntrada.toString() + '</td><td>'
                    + SubSalida.toString() + '</td><td>' + Total.toString() + '</td><td> $ ' + Saldo.toString() + '</td>';
            }
        }
        agregarFila();
        function DataDP(id, polizaid, descripcion, flujo, importe) {
            let flujodesc = '';
            let contador = 1;
            if (flujo == 1) {
                flujodesc = 'Entrada';
                SubEntradaDP = SubEntradaDP + 1;
                SubEntrada = SubEntrada + parseFloat(importe);
                Total = Total + parseFloat(importe);
            } else {
                flujodesc = 'Salida';
                SubSalidaDP = SubSalidaDP + 1;
                SubSalida = SubSalida + parseFloat(importe);
                Total = Total - parseFloat(importe);
            }
            let obj = {
                "id": id,
                "polizaid": polizaid,
                "descripcion": descripcion,
                "flujo": flujodesc,
                "importe": importe
            };
            SubTotalDP = SubTotalDP + 1;
            Movimiento.movimiento.dp.unshift(obj);
            agregarFila();
            document.getElementById("DPtable").insertRow(1).innerHTML = '<td>' + id.toString() + '</td><td>' + polizaid.toString() + '</td><td>'
                + descripcion.toString() + '</td><td>' + flujodesc + '</td><td>' + importe.toString() + '</td><td>'+
                "<a href='#' onclick='DeleteDP(" + id.toString() + ")'><i class='material-icons'>close</i></a>" + '</td > ';
            $('input[name=SubEntradaDP').val(SubEntradaDP.toString());
            $('input[name=SubSalidaDP').val(SubSalidaDP.toString());
            $('input[name=SubTotalDP').val(SubTotalDP.toString());
            Mensaje('Se agrego el registro correctamente', "success");
        }
        function DeleteDP(id) {
            let contador = 0;
            Movimiento.movimiento.dp.forEach(dp => {
                if (dp.id == id) {
                    if (dp.flujo == 'Entrada') {
                        if (SubSalidaDP >= 0) {
                            SubEntradaDP = SubEntradaDP - 1;
                        }
                        
                    } else {
                        if (SubSalidaDP >= 0) {
                            SubSalidaDP = SubSalidaDP - 1;
                        }
                       
                    }
                    SubTotalDP = SubTotalDP - 1;
                    Movimiento.movimiento.dp.splice(contador, 1);
                    document.getElementById("DPtable").deleteRow(contador + 1);
                    $('input[name=SubEntradaDP').val(SubEntradaDP.toString());
                    $('input[name=SubSalidaDP').val(SubSalidaDP.toString());
                    $('input[name=SubTotalDP').val(SubTotalDP.toString());
                    Mensaje('Se elimino el registro correctamente', "success");
                }
                contador = contador + 1;
            });    
        }
        function DataCXP(id, polizaid, descripcion, flujo, importe) {
            let flujodesc = flujo == 1 ? 'Entrada' : 'Salida';
            let contador = 1;
            let obj = {
                "id": id,
                "polizaid": polizaid,
                "descripcion": descripcion,
                "flujo": flujodesc,
                "importe": importe
            };

            Movimiento.movimiento.cxp.unshift(obj)
            document.getElementById("CXPtable").insertRow(1).innerHTML = '<td>' + id.toString() + '</td><td>' + polizaid.toString() + '</td><td>'
                + descripcion.toString() + '</td><td>' + flujodesc + '</td><td> ' + importe.toString() + '</td><td>' +
                "<a href='#' onclick='DeleteCXP(" + id.toString() + ")'><i class='material-icons'>close</i></a>" + '</td > ';
            Mensaje('Se agrego el registro correctamente', "success");
        }
        function DeleteCXP(id) {
            let contador = 0;
            Movimiento.movimiento.cxp.forEach(dp => {
                if (dp.id == id) {
                    Movimiento.movimiento.cxp.splice(contador, 1);
                    document.getElementById("CXPtable").deleteRow(contador + 1);
                    Mensaje('Se elimino el registro correctamente', "success");
                }
                contador = contador + 1;
            });
        }
        function DataCXC(id, polizaid, importe, numeral, importeIncr) {
            let contador = 1;
            let obj = {
                "id": id,
                "polizaid": polizaid,
                "importe": importe,
                "numeral": numeral,
                "importeIncr": importeIncr,
            };

            Movimiento.movimiento.cxc.unshift(obj)
            document.getElementById("CXCtable").insertRow(1).innerHTML = '<td>' + id.toString() + '</td><td>' + polizaid.toString() + '</td><td>'
                + importe.toString() + '</td><td>' + numeral.toString() + '</td><td>' + importeIncr.toString() + '</td><td>' +
                "<a href='#' onclick='DeleteCXC(" + id.toString() + ")'><i class='material-icons'>close</i></a>" + '</td > ';
            Mensaje('Se agrego el registro correctamente', "success");
        }
        function DeleteCXC(id) {
            let contador = 0;
            Movimiento.movimiento.cxc.forEach(dp => {
                if (dp.id == id) {
                    Movimiento.movimiento.cxc.splice(contador, 1);
                    document.getElementById("CXCtable").deleteRow(contador + 1);
                    Mensaje('Se elimino el registro correctamente', "success");
                }
                contador = contador + 1;
            });
        }
        function DataTrans(id, tipo, importe, referencias, origen) {
            let contador = 1;
            let obj = {
                "id": id,
                "tipo": tipo,
                "importe": importe,
                "referencias": referencias,
                "origen": origen
            };

            Movimiento.movimiento.trans.unshift(obj)
            document.getElementById("Transtable").insertRow(1).innerHTML = '<td>' + id.toString() + '</td><td>' + tipo.toString() + '</td><td>'
                + importe.toString() + '</td><td>' + referencias + '</td><td> $ ' + origen.toString() + '</td><td>' +
                "<a href='#' onclick='DeleteTrans(" + id.toString() + ")'><i class='material-icons'>close</i></a>" + '</td > ';
            Mensaje('Se agrego el registro correctamente', "success");
        }
        function DeleteTrans(id) {
            let contador = 0;
            Movimiento.movimiento.trans.forEach(dp => {
                if (dp.id == id) {
                    Movimiento.movimiento.trans.splice(contador, 1);
                    document.getElementById("Transtable").deleteRow(contador + 1);
                    Mensaje('Se elimino el registro correctamente', "success");
                }
                contador = contador + 1;
            });
        }
        function Mensaje(mensaje, tipo) {
            $.notify({
                icon: "add_alert",
                message: mensaje

            }, {
                type: tipo,
                timer: 5000,
                placement: {
                    from: "top",
                    align: "right"
                }
            });
        }
        function GenerarMovimiento() {
            swal({
                title: '¿Seguro de realizar el movimiento maestro?',
                text: "Todos los conceptos que se muestran en la pantalla quedaran agrupados en un movimiento maestro",
                type: 'warning',
                showCancelButton: true,
                confirmButtonClass: 'btn btn-success',
                cancelButtonClass: 'btn btn-danger',
                confirmButtonText: 'Si, generar!',
                buttonsStyling: false
            }).then(function () {
                $.ajax({
                    type: "POST",
                    url: "../../movimientos/GenerarMovimiento",
                    data: {
                        datos: JSON.stringify(Movimiento.movimiento)
                    },
                    success: function (response) {
                        console.log(response);
                        if (response == "Save") {
                            swal({
                                title: 'SE ha generado el movimiento de forma correcta!',
                                text: 'Estamos generando el recibo correspondiente a los movimientos ingresados',
                                type: 'success',
                                confirmButtonClass: "btn btn-success",
                                buttonsStyling: false
                            });
                        }
                    }
                });
            });
        }
    </script>
}
